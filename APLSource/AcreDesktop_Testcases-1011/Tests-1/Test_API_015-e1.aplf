 R←Test_API_015(stopFlag batchFlag);⎕TRAP;F;path;result;buff;openList
⍝ Exercise the API function `close`.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')

 R←∆Failed

 openList←⎕SE.acreAPI.projects'' ⍝ in case was open from prev test

 F←##.FilesAndDirs
 #.⎕SHADOW'TEMP'
 'TEMP'#.⎕NS''
 #.TEMP.Fooü←{42}

 openList←⎕SE.acreAPI.projects''

 path←{_←F.DeleteFile ⍵ ⋄ ¯4↓⍵}F.GetTempFilename''
 result←∆RunUcmd'CreateProject "',path,'" #.TEMP'

 →GoToTidyUp({⍵[;1]}⎕SE.acreAPI.projects'')≢openList[;1],⊂result
 →GoToTidyUp(≢openList)≢⎕SE.acreAPI.close result
 →GoToTidyUp({⍵[;1]}⎕SE.acreAPI.projects'')≢openList[;1]

 R←∆OK

∆TidyUp:
 ∆RunUcmd'Close #.TEMP'
⍝Done
