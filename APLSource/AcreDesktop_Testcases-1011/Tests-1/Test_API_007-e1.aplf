 R←Test_API_007(stopFlag batchFlag);⎕TRAP;F;path;result;buff
⍝ Exercise the API function `log`.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')

 R←∆Failed

 #.⎕SHADOW'TEMP'
 'TEMP'#.⎕NS''
 #.TEMP.Foo←{42}
 F←##.FilesAndDirs

 ∆ClearLog
 →PassesIf 1=≢buff←⎕SE.acre.Log'all'

 path←{_←F.DeleteFile ⍵ ⋄ ¯4↓⍵}F.GetTempFilename''
 result←∆RunUcmd'CreateProject "',path,'" #.TEMP'
 Assert'#.TEMP'≡result
 ∆RunUcmd'Close #.TEMP'
 result←∆RunUcmd'OpenProject "',path,'"'
 Assert'#.TEMP'≡result

 →GoToTidyUp 8≠≢buff←⎕SE.acre.Log'all'

 #.TEMP.Foo2←{43}
 ∆RunUcmd'SetChanged #.TEMP.Foo2'
 buff←⎕SE.acre.Log'all'
 →GoToTidyUp~∨/' SetChanged '⍷,' ',↑buff

 →GoToTidyUp 2≠≢buff←⎕SE.acre.Log 2

 R←∆OK

∆TidyUp:
 F.RmDir path
 ∆RunUcmd'Close #.TEMP'
⍝Done
